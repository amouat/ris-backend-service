import{d as D,Q as y,i as g,W as N,H as n,c as u,f as t,k as o,t as z,b as m,g as T,T as B,X as E,h as V,l as Y,Y as C,a as l}from"./index-086108b4.js";import{d as c}from"./dayjs.min-633259b2.js";import{u as j,t as F,a as H,b as L}from"./operations-fff23507.js";import{_ as M}from"./InfoModal.vue_vue_type_script_setup_true_lang-e56f4d05.js";import{u as P}from"./loadedNorm-9e86fb28.js";const S={class:"max-w-screen-lg"},Z=t("div",null,[t("h1",{class:"heading-02-regular mb-[1rem]"},"Export"),t("p",null,"Exportieren Sie die Dokumentationseinheit zur Abgabe an die jDV.")],-1),A={class:"bg-white mt-[2rem] p-[2rem]"},R={class:"mb-32"},U=t("h2",{class:"heading-03-regular"},"Zip-Datei steht zum Download bereit.",-1),G={key:0,class:"body-01-reg"},I={class:"mt-[1rem]"},O=["onClick"],Q={key:0,class:"align-middle material-icons ml-[0.5rem] text-20 text-blue-800"},ee=D({__name:"export",setup(W){c.extend(j),c.extend(F);const f=P(),{loadedNorm:r}=y(f),i=g(!1),_=g(!1),h=N({title:"",description:""}),a=n(()=>{var s;const e=((s=r.value)==null?void 0:s.files)??[];return e.length>0?e[e.length-1]:void 0}),v=n(()=>{var e;return(e=a.value)==null?void 0:e.name}),p=n(()=>r.value&&a.value?H(r.value.guid,a.value.hash):void 0),b=n(()=>p.value!=null),k=function(e){return c.utc(e).tz(c.tz.guess()).format("DD.MM.YYYY HH:mm")};async function x(){var s;i.value=!0;const e=((s=r.value)==null?void 0:s.guid)||"";try{const d=await L(e);await new Promise(w=>setTimeout(w,300)),d.status===200&&d.data?await f.load(e):(Object.assign(h,d.error),_.value=!0)}finally{i.value=!1}}return(e,s)=>(l(),u("div",S,[Z,t("div",A,[t("div",R,[U,o(a)?(l(),u("p",G," zuletzt generiert am "+z(k(o(a).createdAt)),1)):m("",!0)]),T(B,{disabled:!o(b)||i.value,download:o(v),href:o(p),label:"Zip Datei speichern",target:"_blank"},null,8,["disabled","download","href"]),t("div",I,[t("a",{class:"link-01-bold underline",href:"#",onClick:E(x,["prevent"])},[V("Neue Zip-Datei generieren "),i.value?(l(),u("span",Q," refresh ")):m("",!0)],8,O)])]),_.value?(l(),Y(M,C({key:0},h,{class:"mt-8"}),null,16)):m("",!0)]))}});export{ee as default};

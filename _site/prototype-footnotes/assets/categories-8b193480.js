import{d as y,a as r,c as m,r as E,B as M,N as te,t as $,F as U,G as K,f as i,g as h,b as F,C as ne,D as oe,l as N,m as D,H as R,e as fe,k as p,h as Le,a2 as Se,i as k,Z as B,n as me,T as W,w as C,j as pe,p as he,q as ve,v as j,P as _e,A as ge,U as q,y as A,L as Ce,a3 as Fe,S as Ne,u as Te,z as Oe}from"./index-086108b4.js";import{e as Y,d as Ee,c as Ie}from"./InputElement.vue_vue_type_script_setup_true_lang-b901796a.js";import{s as ee,c as le,a as ae}from"./coreDataFields-e5e2789f.js";import{_ as ze}from"./Pagination.vue_vue_type_script_setup_true_lang-3db170aa.js";import{K as Ve,S as we,U as Q,O as Re}from"./OriginalFileSidePanel-5c7973b7.js";import{I as de,u as Pe}from"./InputGroup-68f938ce.js";import{I as Be}from"./types-7b85aa56.js";import{T as Ke,s as Ae}from"./TextEditor-f5aaa668.js";import{_ as Me}from"./DocumentUnitWrapper.vue_vue_type_script_setup_true_lang-c12920d0.js";import{d as je}from"./dayjs.min-633259b2.js";import{P as J}from"./documentUnit-2521476f.js";import{d as se}from"./documentUnitService-4c93048b.js";import{u as Ge}from"./useToggleStateInRouteQuery-529f287a.js";import"./FileInput-178c6e95.js";import"./SideToggle.vue_vue_type_script_setup_true_lang-24f80c0e.js";function O(t,e,n){return{name:t,label:e,fieldSize:n}}const He=[O("decisionName","Entscheidungsname","small"),O("headline","Titelzeile","small"),O("guidingPrinciple","Leitsatz","medium"),O("headnote","Orientierungssatz","small"),O("tenor","Tenor","medium"),O("reasons","Gründe","large"),O("caseFacts","Tatbestand","large"),O("decisionReasons","Entscheidungsgründe","large")],We=["onClick","onKeyup"],qe=y({__name:"TokenizeText",props:{text:null,keywords:null},emits:["linkToken:clicked"],setup(t,{emit:e}){const n=t;function o(){return n.keywords.length===0?[{content:n.text,isLink:!1}]:n.text.split(new RegExp(`(${n.keywords.join("|")})`)).map(a=>({content:a,isLink:n.keywords.includes(a)}))}function s(a){a.isLink&&e("linkToken:clicked",a.content)}return(a,l)=>(r(!0),m(U,null,E(o(),(c,f)=>(r(),m("span",{key:f,class:M(c.isLink&&"linked-field"),onClick:u=>s(c),onKeyup:te(u=>s(c),["enter"])},$(c.content),43,We))),128))}});const be=K(qe,[["__scopeId","data-v-ce969719"]]),Je=t=>(ne("data-v-785e8bb8"),t=t(),oe(),t),Qe={class:"flex mt-20"},Ze={class:"flex flex-col grow"},Xe={class:"flex"},Ye={class:"flex label-02-reg pt-8 text-blue-800"},et=["aria-label"],tt={class:"ml-112 text-black"},nt={key:0},ot=["aria-label"],st=Je(()=>i("hr",{class:"border-blue-500 mt-8 w-full"},null,-1)),it=y({__name:"FieldOfLawListEntry",props:{fieldOfLaw:null,showBin:{type:Boolean}},emits:["remove-from-list","node-clicked","linkedField:clicked"],setup(t,{emit:e}){const n=t;function o(s){e("linkedField:clicked",s)}return(s,a)=>(r(),m(U,null,[i("div",Qe,[i("div",Ze,[i("div",Xe,[i("div",Ye,[i("span",{"aria-label":n.fieldOfLaw.identifier+" "+n.fieldOfLaw.text+" im Sachgebietsbaum anzeigen",class:"link mr-12 w-44 whitespace-nowrap",onClick:a[0]||(a[0]=l=>e("node-clicked")),onKeyup:a[1]||(a[1]=te(l=>e("node-clicked"),["enter"]))},$(n.fieldOfLaw.identifier),41,et),i("span",tt,[h(be,{keywords:n.fieldOfLaw.linkedFields??[],text:n.fieldOfLaw.text,"onLinkToken:clicked":o},null,8,["keywords","text"])])])])]),n.showBin?(r(),m("div",nt,[i("button",{"aria-label":t.fieldOfLaw.identifier+" "+t.fieldOfLaw.text+" entfernen",class:"material-icons text-blue-800",onClick:a[2]||(a[2]=l=>e("remove-from-list"))}," delete_outline ",8,ot)])):F("",!0)]),st],64))}});const ke=K(it,[["__scopeId","data-v-785e8bb8"]]),lt={class:"pt-20"},at={key:0},dt={key:1},rt=i("hr",{class:"border-blue-500 mt-20 w-full"},null,-1),ct=y({__name:"FieldOfLawSelectionList",props:{selectedFieldsOfLaw:null},emits:["remove-from-list","node-clicked","linkedField:clicked"],setup(t,{emit:e}){const n=t;return(o,s)=>(r(),m("div",lt,[n.selectedFieldsOfLaw.length?(r(),m("div",dt,[rt,(r(!0),m(U,null,E(n.selectedFieldsOfLaw,a=>(r(),N(ke,{key:a.identifier,"field-of-law":a,"show-bin":"","onLinkedField:clicked":s[0]||(s[0]=l=>e("node-clicked",l)),onNodeClicked:l=>e("node-clicked",a.identifier),onRemoveFromList:l=>e("remove-from-list",a.identifier)},null,8,["field-of-law","onNodeClicked","onRemoveFromList"]))),128))])):(r(),m("div",at," Die Liste ist aktuell leer "))]))}}),H="root";function ut(){return{identifier:H,text:"Alle Sachgebiete anzeigen",children:[],childrenCount:17,norms:[],isExpanded:!1}}function ft(t){const e=[],n=(o,s)=>{s.push(o),o.children.forEach(a=>n(a,s))};return n(t,e),e}const P={async getSelectedFieldsOfLaw(t){const e=await D.get(`caselaw/documentunits/${t}/contentrelatedindexing/fieldsoflaw`);return e.status>=300&&(e.error={title:`Sachgebiete für die Dokumentationseinheit ${t} konnten nicht geladen werden.`}),e},async addFieldOfLaw(t,e){const n=await D.put(`caselaw/documentunits/${t}/contentrelatedindexing/fieldsoflaw/${e}`);return n.status>=300&&(n.error={title:`Sachgebiet ${e} konnte nicht zu
          Dokumentationseinheit ${t} hinzugefügt werden`}),n},async removeFieldOfLaw(t,e){const n=await D.delete(`caselaw/documentunits/${t}/contentrelatedindexing/fieldsoflaw/${e}`);return n.status>=300&&(n.error={title:`Sachgebiet ${e} konnte nicht von der
        Dokumentationseinheit ${t} entfernt werden`}),n},async getChildrenOf(t){const e=await D.get(`caselaw/fieldsoflaw/${t}/children`);return e.status>=300&&(e.error={title:"Sachgebiete unterhalb von "+t+" konnten nicht geladen werden."}),e},async getTreeForIdentifier(t){const e=await D.get(`caselaw/fieldsoflaw/${t}/tree`);return e.status>=300&&(e.error={title:"Pfad zu ausgewähltem Sachgebiet konnte nicht geladen werden."}),e},async searchForFieldsOfLaw(t,e,n){const o=await D.get(`caselaw/fieldsoflaw?pg=${t}&sz=${e}`,{params:{q:n??""}});return o.status>=300&&(o.error={title:"Die Suche nach Sachgebieten konnte nicht ausgeführt werden."}),o}},mt={class:"flex flex-row"},pt={key:0,class:"pl-24"},ht={key:1},vt=["aria-label"],_t={key:2},gt=["aria-label"],wt={key:0,"aria-label":"Sachgebiet entfernen",class:"material-icons selected-icon"},bt={class:"flex flex-col"},kt={class:"flex flex-row"},yt={key:0,class:"identifier pl-8"},xt={class:"font-size-14px pl-6 pt-2 text-blue-800"},$t={key:0,class:"flex flex-col pb-6 pl-8"},Dt={class:"flex flex-row flex-wrap font-size-14px norms-font-color"},Ut={key:0},Lt=y({__name:"FieldOfLawNodeComponent",props:{selectedNodes:null,node:null,selected:{type:Boolean},showNorms:{type:Boolean}},emits:["node:toggle","node:select","node:unselect","linkedField:clicked"],setup(t,{emit:e}){const n=t,o=R(()=>n.node);function s(c){e("linkedField:clicked",c)}function a(){return o.value.childrenCount>o.value.children.length}async function l(){if(a()){let c;o.value.children.length>0&&(c=Se(o.value.children[0])),await P.getChildrenOf(o.value.identifier).then(f=>{if(!f.data||(o.value.children=f.data,!c))return;const u=o.value.children.find(v=>v.identifier===c.identifier);u&&(u.children=c.children,u.isExpanded=!0,u.inDirectPathMode=!0)})}o.value.inDirectPathMode?o.value.inDirectPathMode=!1:o.value.isExpanded=!o.value.isExpanded}return(c,f)=>{const u=fe("FieldOfLawNodeComponent",!0);return r(),m("div",{class:M(["flex flex-col",p(o).identifier!==p(H)?"pl-36":""])},[i("div",mt,[p(o).childrenCount===0?(r(),m("div",pt)):(r(),m("div",ht,[i("button",{"aria-label":p(o).identifier+" "+p(o).text+" aufklappen",class:"bg-blue-200 material-icons rounded-full text-blue-800 w-icon",onClick:l},$(a()||!n.node.isExpanded?"add":"remove"),9,vt)])),p(o).identifier!==p(H)?(r(),m("div",_t,[i("button",{"aria-label":p(o).identifier+" "+p(o).text+(t.selected?" entfernen":" hinzufügen"),class:"align-top appearance-none border-2 focus:outline-2 h-24 hover:outline-2 ml-12 outline-0 outline-blue-800 outline-none outline-offset-[-4px] rounded-sm text-blue-800 w-24",onClick:f[0]||(f[0]=v=>t.selected?e("node:unselect",p(o).identifier):e("node:select",p(o)))},[t.selected?(r(),m("span",wt," done ")):F("",!0)],8,gt)])):F("",!0),i("div",null,[i("div",bt,[i("div",kt,[p(o).identifier!==p(H)?(r(),m("div",yt,$(p(o).identifier),1)):F("",!0),i("div",xt,[h(be,{keywords:n.node.linkedFields??[],text:n.node.text,"onLinkToken:clicked":s},null,8,["keywords","text"])])])]),t.showNorms?(r(),m("div",$t,[i("div",Dt,[(r(!0),m(U,null,E(p(o).norms,(v,_)=>(r(),m("span",{key:_},[i("strong",null,$(v.singleNormDescription),1),Le(" "+$(v.abbreviation)+$(_<p(o).norms.length-1?", ":""),1)]))),128))])])):F("",!0)])]),p(o).isExpanded&&p(o).children.length?(r(),m("div",Ut,[(r(!0),m(U,null,E(p(o).children,v=>(r(),N(u,{key:v.identifier,node:v,selected:n.selectedNodes.some(({identifier:_})=>_===v.identifier),"selected-nodes":t.selectedNodes,"show-norms":t.showNorms,"onLinkedField:clicked":f[1]||(f[1]=_=>e("linkedField:clicked",_)),"onNode:select":f[2]||(f[2]=_=>e("node:select",_)),"onNode:unselect":f[3]||(f[3]=_=>e("node:unselect",_))},null,8,["node","selected","selected-nodes","show-norms"]))),128))])):F("",!0)],2)}}});const St=K(Lt,[["__scopeId","data-v-64ba0db4"]]),ye=t=>(ne("data-v-ca0f9eab"),t=t(),oe(),t),Ct={class:"flex items-center justify-between pb-10"},Ft=ye(()=>i("h1",{class:"heading-03-regular"},"Sachgebietsbaum",-1)),Nt={class:"flex items-center"},Tt={key:0,"aria-label":"Sachgebiet entfernen",class:"material-icons selected-icon"},Ot=ye(()=>i("span",{class:"pl-8"},"Normen anzeigen",-1)),Et=y({__name:"FieldOfLawTree",props:{selectedNodes:null,clickedIdentifier:null,showNorms:{type:Boolean}},emits:["add-to-list","remove-from-list","reset-clicked-node","toggle-show-norms","linkedField:clicked"],setup(t,{emit:e}){const n=t,o=k(ut()),s=R(()=>n.clickedIdentifier);B(s,()=>f(s.value));function a(u){e("add-to-list",u.identifier)}function l(u){e("remove-from-list",u)}function c(u){e("linkedField:clicked",u)}const f=async u=>{if(!u)return;const v=await P.getTreeForIdentifier(u);v.data&&(o.value.children=[v.data],ft(o.value).forEach(_=>{_.isExpanded=!0,_.inDirectPathMode=!0}),e("reset-clicked-node"))};return(u,v)=>(r(),m(U,null,[i("div",Ct,[Ft,i("div",Nt,[i("button",{"aria-label":"Normen anzeigen",class:"align-top appearance-none border-2 focus:outline-2 h-24 hover:outline-2 outline-0 outline-blue-800 outline-none outline-offset-[-4px] rounded-sm text-blue-800 w-24",onClick:v[0]||(v[0]=_=>e("toggle-show-norms"))},[t.showNorms?(r(),m("span",Tt," done ")):F("",!0)]),Ot])]),(r(),N(St,{key:o.value.identifier,node:o.value,selected:n.selectedNodes.some(({identifier:_})=>_===o.value.identifier),"selected-nodes":t.selectedNodes,"show-norms":t.showNorms,"onLinkedField:clicked":c,"onNode:select":a,"onNode:unselect":l},null,8,["node","selected","selected-nodes","show-norms"]))],64))}});const It=K(Et,[["__scopeId","data-v-ca0f9eab"]]),zt=i("p",{class:"heading-04-regular pb-8 pt-24"},"Direkteingabe Sachgebiet",-1),Vt={class:"flex flex-col w-1/3"},Rt={class:"flex flex-row items-stretch"},Pt={class:"grow"},Bt=y({__name:"FieldOfLawDirectInputSearch",emits:["add-to-list"],setup(t,{emit:e}){function n(o){o&&e("add-to-list",o.label)}return(o,s)=>(r(),m(U,null,[zt,i("div",Vt,[i("div",Rt,[i("div",Pt,[h(Y,{id:"directInputCombobox","aria-label":"Direkteingabe-Sachgebietssuche eingeben","clear-on-choosing-item":"","item-service":p(ee).getFieldOfLawSearchByIdentifier,placeholder:"Sachgebiet","onUpdate:modelValue":n},null,8,["item-service"])])])])],64))}}),Kt=i("h1",{class:"heading-03-regular pb-8"},"Suche",-1),At={class:"flex flex-col"},Mt={class:"pb-28"},jt={class:"flex flex-row items-stretch"},Gt={class:"grow"},Ht={class:"pl-8"},Wt=y({__name:"FieldOfLawSearch",emits:["linkedField:clicked","node-clicked","do-show-norms"],setup(t,{emit:e}){const n=k(""),o=k(),s=k(),a=10;async function l(c){var u;console.log(c);const f=await P.searchForFieldsOfLaw(c,a,n.value);f.data?(s.value=f.data,o.value=f.data.content,(u=o.value)!=null&&u[0]&&e("node-clicked",o.value[0].identifier),n.value.includes("norm:")&&e("do-show-norms")):(s.value=void 0,o.value=void 0,console.error("Error searching for Nodes"))}return(c,f)=>(r(),m(U,null,[Kt,i("div",At,[i("div",Mt,[i("div",jt,[i("div",Gt,[h(me,{id:"FieldOfLawSearchTextInput",modelValue:n.value,"onUpdate:modelValue":f[0]||(f[0]=u=>n.value=u),"aria-label":"Sachgebiete Suche","full-height":"",onEnterReleased:f[1]||(f[1]=u=>l(0))},null,8,["modelValue"])]),i("div",Ht,[h(W,{"aria-label":"Sachgebietssuche ausführen","button-type":"secondary",class:"w-fit",label:"Suchen",onClick:f[2]||(f[2]=u=>l(0))})])])]),s.value?(r(),N(ze,{key:0,"navigation-position":"bottom",page:s.value,onUpdatePage:l},{default:C(()=>[(r(!0),m(U,null,E(o.value,(u,v)=>(r(),N(ke,{key:v,"field-of-law":u,"onLinkedField:clicked":f[3]||(f[3]=_=>e("node-clicked",_)),onNodeClicked:_=>e("node-clicked",u.identifier)},null,8,["field-of-law","onNodeClicked"]))),128))]),_:1},8,["page"])):F("",!0)])],64))}}),qt={class:"w-full"},Jt={class:"flex flex-row"},Qt={class:"bg-white flex flex-1 flex-col p-20"},Zt={class:"bg-white flex-1 p-20"},Xt=i("hr",{class:"border-blue-700 w-full"},null,-1),Yt={class:"bg-white p-20"},en=i("h1",{class:"heading-03-regular pb-8"},"Ausgewählte Sachgebiete",-1),tn=y({__name:"FieldOfLawMain",props:{documentUnitUuid:null},async setup(t){let e,n;const o=t,s=k([]),a=k(""),l=k(!1),c=([e,n]=pe(()=>P.getSelectedFieldsOfLaw(o.documentUnitUuid)),e=await e,n(),e);c.data&&(s.value=c.data);const f=async d=>{const w=await P.addFieldOfLaw(o.documentUnitUuid,d);w.data&&(s.value=w.data)},u=async d=>{const w=await P.removeFieldOfLaw(o.documentUnitUuid,d);w.data&&(s.value=w.data)};function v(d){a.value=d}function _(){a.value=""}function I(d){a.value=d}function z(d){setTimeout(()=>{a.value=d},20)}function L(d){return j("div",[j("span",{class:"text-blue-800",onClick:()=>z(d.identifier)},d.identifier),", "+d.text])}const g=he(L);return(d,w)=>(r(),N(ve,{"as-column":"","data-set":s.value,"summary-component":p(g),title:"Sachgebiete"},{default:C(()=>[i("div",qt,[i("div",Jt,[i("div",Qt,[h(Wt,{"show-norms":l.value,onDoShowNorms:w[0]||(w[0]=T=>l.value=!0),onNodeClicked:v},null,8,["show-norms"])]),i("div",Zt,[h(It,{"clicked-identifier":a.value,"selected-nodes":s.value,"show-norms":l.value,onAddToList:f,"onLinkedField:clicked":I,onRemoveFromList:u,onResetClickedNode:_,onToggleShowNorms:w[1]||(w[1]=T=>l.value=!l.value)},null,8,["clicked-identifier","selected-nodes","show-norms"])])]),Xt,i("div",Yt,[en,h(Bt,{onAddToList:f}),h(ct,{"selected-fields-of-law":s.value,"onLinkedField:clicked":I,onNodeClicked:v,onRemoveFromList:u},null,8,["selected-fields-of-law"])])])]),_:1},8,["data-set","summary-component"]))}}),Z={async getKeywords(t){const e=await D.get(`caselaw/documentunits/${t}/contentrelatedindexing/keywords`);return e.status>=300&&(e.error={title:"Schlagwörter konnten nicht geladen werden."}),e},async addKeyword(t,e){const n=encodeURIComponent(e),o=`caselaw/documentunits/${t}/contentrelatedindexing/keywords/${n}`,s=await D.put(o);return s.status>=300&&(s.error={title:`Schlagwort ${e} konnte nicht hinzugefügt werden`}),s},async deleteKeyword(t,e){const n=encodeURIComponent(e),o=`caselaw/documentunits/${t}/contentrelatedindexing/keywords/${n}`,s=await D.delete(o);return s.status>=300&&(s.error={title:`Schlagwort ${e} konnte nicht entfernt werden`}),s}},nn={class:"bg-white mb-[2rem] p-16"},on=i("h2",{class:"label-02-bold mb-[1rem]"},"Schlagwörter",-1),sn={class:"flex flex-row"},ln={class:"flex-1"},an=y({__name:"KeyWords",props:{documentUnitUuid:null},setup(t){const e=t,n=k([]),o=k(),s=async l=>{if(l!==void 0){const c=await Z.addKeyword(e.documentUnitUuid,l);if(c.error){o.value=c.error;return}c.data&&(n.value=c.data)}},a=async l=>{if(l!==void 0){const c=await Z.deleteKeyword(e.documentUnitUuid,l);if(c.error){o.value=c.error;return}c.data&&(n.value=c.data)}};return B(e,async()=>{const l=await Z.getKeywords(e.documentUnitUuid);if(l.error){o.value=l.error;return}l.data&&(n.value=l.data)},{immediate:!0}),(l,c)=>(r(),m("div",nn,[on,i("div",sn,[i("div",ln,[h(Ve,{id:"keywords","aria-label":"Schlagwörter",error:o.value,"model-value":n.value,onAddChip:s,onDeleteChip:a},null,8,["error","model-value"])])])]))}}),dn={class:"mb-[4rem]"},rn=i("h1",{class:"heading-02-regular mb-[1rem]"},"Inhaltliche Erschließung",-1),cn=y({__name:"DocumentUnitContentRelatedIndexing",props:{documentUnit:null},setup(t){const e=t;return(n,o)=>(r(),m("div",dn,[rn,h(an,{"document-unit-uuid":e.documentUnit.uuid},null,8,["document-unit-uuid"]),h(tn,{"document-unit-uuid":e.documentUnit.uuid},null,8,["document-unit-uuid"])]))}});function re(t){return t.charAt(0).toUpperCase()+t.slice(1)}function ce(t){return t.charAt(0).toLowerCase()+t.slice(1)}function un(t,e){return"nestedInputOf"+re(t)+"And"+re(e)}function fn(t){const e=/^nestedInputOf(.*)And(.*)/g.exec(t);if(e)return{parentKey:ce(e[1]),childKey:ce(e[2])};throw new Error("Could not extract keys from neste input key")}function mn(t,e,n){const o={...t};delete o[e],delete o[n];const s=un(e,n);return Object.assign(o,{[s]:{fields:{parent:t[e],child:t[n]}}}),o}function pn(t){const e={...t};for(const[n,o]of Object.entries(t))if(typeof o=="object"&&o!==null&&"fields"in o&&"parent"in o.fields&&"child"in o.fields){const{parentKey:s,childKey:a}=fn(n);delete e[n],e[s]=o.fields.parent,e[a]=o.fields.child}return e}function ue(t,e,n){return R({get:()=>{let o=t.value;return e.filter(s=>s.type===Be.NESTED).forEach(s=>{o=mn(o,s.inputAttributes.fields.parent.name,s.inputAttributes.fields.child.name)}),o},set:o=>{const s=pn(o);n("update:modelValue",s)}})}const hn={key:0},vn={key:1,class:"mb-[4rem]"},_n=i("h1",{class:"core-data heading-02-regular mb-[1rem]"},"Stammdaten",-1),gn=i("div",{class:"mt-4"},"* Pflichtfelder zum Veröffentlichen",-1),wn=y({__name:"DocumentUnitCoreData",props:{modelValue:null,updateStatus:null,validationErrors:null},emits:["updateDocumentUnit","update:modelValue"],setup(t,{emit:e}){const n=t,{modelValue:o}=_e(n),s=ue(o,ae,e),a=ue(o,le,e),l=k(),c=R(()=>l.value<600?1:2);ge(()=>{const u=document.querySelector(".core-data");u!=null&&f.observe(u)});const f=new ResizeObserver(u=>{for(const v of u)l.value=v.contentRect.width});return(u,v)=>p(o)?(r(),m("div",vn,[_n,h(de,{modelValue:p(a),"onUpdate:modelValue":v[0]||(v[0]=_=>q(a)?a.value=_:null),"column-count":1,fields:p(le),"validation-errors":n.validationErrors},null,8,["modelValue","fields","validation-errors"]),h(de,{modelValue:p(s),"onUpdate:modelValue":v[1]||(v[1]=_=>q(s)?s.value=_:null),"column-count":p(c),fields:p(ae),"validation-errors":n.validationErrors},null,8,["modelValue","column-count","fields","validation-errors"]),gn,h(we,{"aria-label":"Stammdaten Speichern Button",class:"mt-8","update-status":t.updateStatus,onUpdateDocumentUnit:v[2]||(v[2]=_=>e("updateDocumentUnit"))},null,8,["update-status"])])):(r(),m("div",hn,"Loading..."))}}),bn={class:"mb-[4rem]"},kn=i("h1",{class:"heading-02-regular mb-[1rem]"},"Kurz- & Langtexte",-1),yn={class:"flex flex-col gap-36"},xn=["for"],$n=y({__name:"DocumentUnitTexts",props:{texts:null,updateStatus:null},emits:["updateValue","updateDocumentUnit"],setup(t,{emit:e}){const n=t,o=R(()=>He.map(s=>({id:s.name,name:s.name,label:s.label,aria:s.label,fieldSize:s.fieldSize,value:n.texts[s.name]})));return(s,a)=>(r(),m("div",bn,[kn,i("div",yn,[(r(!0),m(U,null,E(p(o),l=>(r(),m("div",{key:l.id,class:""},[i("label",{class:"label-02-regular mb-2",for:l.id},$(l.label),9,xn),h(Ke,{id:l.id,"aria-label":l.aria,class:"outline outline-2 outline-blue-900",editable:"","field-size":l.fieldSize,value:l.value,onUpdateValue:c=>e("updateValue",[l.id,c])},null,8,["id","aria-label","field-size","value","onUpdateValue"])]))),128)),h(we,{"aria-label":"Kurz- und Langtexte Speichern Button","update-status":t.updateStatus,onUpdateDocumentUnit:a[0]||(a[0]=l=>e("updateDocumentUnit"))},null,8,["update-status"])])]))}}),Dn={class:"underline"},Un={key:1,class:"label-02-reg"},xe=y({__name:"InlineDecision",props:{decision:null},setup(t){return(e,n)=>{const o=fe("router-link");return r(),m("div",null,[t.decision.hasLink?(r(),N(o,{key:0,class:"link-01-bold underline",tabindex:"-1",target:"_blank",to:{name:"caselaw-documentUnit-:documentNumber-categories",params:{documentNumber:t.decision.documentNumber}}},{default:C(()=>[i("button",Dn,$(t.decision.renderDecision),1)]),_:1},8,["to"])):(r(),m("span",Un,$(t.decision.renderDecision),1))])}}}),Ln={class:"flex flex-col items-start text-start w-full"},Sn=["onClick","onKeyup"],Cn=y({__name:"DecisionList",props:{decisions:null},emits:["removeLink"],setup(t,{emit:e}){const n=t,o=R(()=>[...n.decisions].sort((s,a)=>je(a.date).diff(s.date)));return(s,a)=>(r(),m("div",Ln,[(r(!0),m(U,null,E(p(o),l=>(r(),m("div",{key:l.uuid,class:"border-b-1 border-b-blue-500 first:pt-0 flex flex-start justify-between label-02-reg last:border-none last:pb-0 py-10 w-full"},[h(xe,{decision:l},null,8,["decision"]),i("span",{"aria-label":"Löschen",class:"cursor-pointer font-base icon material-icons ml-[1.5rem] text-blue-800",tabindex:"0",onClick:c=>e("removeLink",l),onKeyup:te(c=>e("removeLink",l),["enter"])},"delete_outline",40,Sn)]))),128))]))}}),Fn={class:"label-02-bold"},Nn={class:"table"},Tn={class:"table-cell"},On={class:"p-8 table-cell"},En={key:0,class:"bg-green-700 label-03-reg ml-24 px-24 py-4 rounded-full text-white"},In=y({__name:"SearchResultList",props:{searchResults:null},emits:["linkDecision"],setup(t,{emit:e}){const n=t,o=k("Noch keine Suchparameter eingegeben");return B(n,()=>{n.searchResults&&(n.searchResults.length>0?o.value=`Suche hat ${n.searchResults.length} Treffer ergeben`:o.value="Suche hat keine Treffer ergeben")}),(s,a)=>(r(),m("div",null,[i("span",Fn,$(o.value),1),i("div",Nn,[(r(!0),m(U,null,E(t.searchResults,l=>(r(),m("div",{key:l.decision.uuid,class:"mb-24 mt-12 table-row"},[i("div",Tn,[h(xe,{decision:l.decision},null,8,["decision"])]),i("div",On,[h(W,{"aria-label":"Treffer übernehmen",class:"ml-24",disabled:l.isLinked,label:"Übernehmen",onClick:c=>e("linkDecision",l.decision.uuid)},null,8,["disabled","onClick"])]),l.isLinked?(r(),m("span",En,"Bereits hinzugefügt")):F("",!0)]))),128))])]))}}),X={async createProceedingDecision(t,e){const n=await D.put(`caselaw/documentunits/${t}/proceedingdecisions`,{headers:{Accept:"application/json","Content-Type":"application/json"}},e);return n.status>=300?{status:500,error:{title:`Vorgehende Entscheidung konnte nicht zu
          Dokumentationseinheit ${t} hinzugefügt werden`}}:{status:200,data:n.data.map(o=>new J({...o}))}},async linkProceedingDecision(t,e){const n=await D.put(`caselaw/documentunits/${t}/proceedingdecisions/${e}`);return n.status>=300?{status:500,error:{title:`Vorgehende Entscheidung ${e} konnte der Dokumentationseinheit ${t} nicht hinzugefügt werden.`}}:{status:200,data:n.data.proceedingDecisions.map(o=>new J({...o}))}},async removeProceedingDecision(t,e){const n=await D.delete(`caselaw/documentunits/${t}/proceedingdecisions/${e}`);return n.status>=300&&(n.error={title:`Vorgehende Entscheidung ${e} für die Dokumentationseinheit ${t} konnten nicht entfernt werden.`}),n}},zn=t=>(ne("data-v-2b7159a9"),t=t(),oe(),t),Vn={class:"mb-[4rem]"},Rn=zn(()=>i("h1",{class:"heading-02-regular mb-[1rem]"},"Rechtszug",-1)),Pn={class:"fake-input-group"},Bn={class:"fake-input-group__row pb-32"},Kn={class:"fake-input-group__row__field flex-col"},An={class:"fake-input-group__row pb-32"},Mn={class:"mb-10 mt-20"},jn=y({__name:"ProceedingDecisions",props:{documentUnitUuid:null,proceedingDecisions:null},setup(t){const e=t,n=k(),o=k(),s=k(new J);function a({court:g,date:d,fileNumber:w,documentType:T}){return[g,d,w,T].some(G=>G!=null)}async function l(g){if(a(g)){const d=await X.createProceedingDecision(e.documentUnitUuid,g);d.data?n.value=d.data:console.error(d.error)}c()}function c(){s.value=new J}async function f(g){const d=await X.linkProceedingDecision(e.documentUnitUuid,g);d.data?(n.value=d.data,_(g)):console.error(d.error),c()}async function u(g){var w;const d=await X.removeProceedingDecision(e.documentUnitUuid,g.uuid);d.data?(n.value=(w=n.value)==null?void 0:w.filter(T=>T.uuid!==g.uuid),_(g.uuid)):console.error(d.error)}function v(g){return n.value?n.value.some(d=>d.uuid==g.uuid):!1}function _(g){o.value!=null&&(o.value=o.value.map(d=>(d.decision.uuid===g&&(d.isLinked=!d.isLinked),d)))}async function I(){const g=await se.searchByProceedingDecisionInput(s.value);g.data&&(o.value=g.data.map(d=>({decision:d,isLinked:v(d)})))}function z(g){return j("div",{tabindex:g.hasLink?0:-1},[g.hasLink?j(Fe,{class:["link-01-bold","underline"],target:"_blank",tabindex:-1,to:{name:"caselaw-documentUnit-:documentNumber-categories",params:{documentNumber:g.documentNumber}}},g.renderDecision):j("span",{class:["link-02-reg"]},g.renderDecision)])}const L=he(z);return B(e,()=>{n.value=e.proceedingDecisions},{immediate:!0}),B(s,()=>{s.value.dateKnown||(s.value.date=void 0)},{immediate:!0,deep:!0}),(g,d)=>(r(),m("div",Vn,[Rn,h(ve,{"as-column":"","data-set":n.value,"fallback-text":"Noch keine vorhergehende Entscheidung hinzugefügt.","summary-component":p(L),title:"Vorgehende Entscheidungen"},{default:C(()=>[n.value?(r(),N(Cn,{key:0,decisions:n.value,onRemoveLink:u},null,8,["decisions"])):F("",!0),i("div",Pn,[i("div",Bn,[h(A,{id:"court",class:"fake-input-group__row__field flex-col",label:"Gericht *"},{default:C(()=>[h(Y,{id:"court",modelValue:s.value.court,"onUpdate:modelValue":d[0]||(d[0]=w=>s.value.court=w),"aria-label":"Gericht Rechtszug","item-service":p(ee).getCourts,placeholder:"Gerichtstyp Gerichtsort"},null,8,["modelValue","item-service"])]),_:1}),i("div",Kn,[h(A,{id:"date",class:"w-full",label:"Entscheidungsdatum *"},{default:C(()=>[h(Ee,{id:"date",modelValue:s.value.date,"onUpdate:modelValue":d[1]||(d[1]=w=>s.value.date=w),"aria-label":"Entscheidungsdatum Rechtszug",disabled:s.value.dateUnknown},null,8,["modelValue","disabled"])]),_:1}),h(A,{id:"dateUnknown",label:"Datum unbekannt","label-position":p(Ce).RIGHT},{default:C(()=>[h(Ie,{id:"dateUnknown",modelValue:s.value.dateUnknown,"onUpdate:modelValue":d[2]||(d[2]=w=>s.value.dateUnknown=w),"aria-label":"Datum Unbekannt"},null,8,["modelValue"])]),_:1},8,["label-position"])])]),i("div",An,[h(A,{id:"fileNumber",class:"fake-input-group__row__field flex-col",label:"Aktenzeichen *"},{default:C(()=>[h(me,{id:"fileNumber",modelValue:s.value.fileNumber,"onUpdate:modelValue":d[3]||(d[3]=w=>s.value.fileNumber=w),"aria-label":"Aktenzeichen Rechtszug"},null,8,["modelValue"])]),_:1}),h(A,{id:"documentType",class:"fake-input-group__row__field flex-col",label:"Dokumenttyp"},{default:C(()=>[h(Y,{id:"documentType",modelValue:s.value.documentType,"onUpdate:modelValue":d[4]||(d[4]=w=>s.value.documentType=w),"aria-label":"Dokumenttyp Rechtszug","item-service":p(ee).getDocumentTypes,placeholder:"Bitte auswählen"},null,8,["modelValue","item-service"])]),_:1})])]),i("div",null,[h(W,{"aria-label":"Nach Entscheidungen suchen","button-type":"secondary",class:"mr-28",label:"Suchen",onClick:I}),h(W,{"aria-label":"Entscheidung manuell hinzufügen","button-type":"tertiary",label:"Manuell Hinzufügen",onClick:d[5]||(d[5]=w=>l(s.value))})]),i("div",Mn,[h(In,{"search-results":o.value,onLinkDecision:f},null,8,["search-results"])])]),_:1},8,["data-set","summary-component"])]))}});const Gn=K(jn,[["__scopeId","data-v-2b7159a9"]]),Hn={class:"flex w-full"},Wn=y({__name:"DocumentUnitCategories",props:{documentUnit:null},setup(t){const e=t,n=k(e.documentUnit),o=async b=>{const x=document.createElement("div");x.innerHTML=b[1];const V=x.getElementsByTagName("img").length>0,S=x.getElementsByTagName("table").length>0,Ue=x.innerText.length>0;n.value.texts[b[0]]=Ue||V||S?b[1]:""},s=async()=>{var x;u.value=Q.ON_UPDATE;const b=await se.update(n.value);(x=b==null?void 0:b.error)!=null&&x.validationErrors?f.value=b.error.validationErrors:f.value=[],b.data&&(n.value=b.data),z.value=!1,v.value=JSON.stringify(n.value),u.value=b.status},a=Te(),l=Oe(),c=k(navigator.onLine),f=k([]),u=k(Q.BEFORE_UPDATE),v=k(JSON.stringify(e.documentUnit)),_=k(""),I=k(),z=k(!1),L=Ge("showDocPanel",l,a.replace,!1);B(L,async()=>{L.value&&_.value.length==0&&await G()},{immediate:!0});const g=R({get:()=>n.value.coreData,set:b=>{var V,S;let x=!1;((V=n.value.coreData.court)==null?void 0:V.label)!==((S=b.court)==null?void 0:S.label)&&(x=!0),Object.assign(n.value.coreData,b),x&&s()}}),{hash:d}=_e(l);Pe(d);const w=k(!1);function T(){const b=document.getElementById("odoc-panel-element");b&&(b.getBoundingClientRect().top<=0&&L.value===!0?w.value=!0:w.value=!1)}async function G(){if(!(_.value.length>0)&&e.documentUnit.s3path){const b=await Ae.getDocxFileAsHtml(e.documentUnit.s3path);b.error===void 0&&(_.value=b.data)}}const ie=async b=>{if((navigator.userAgent.indexOf("Mac")!=-1?"Mac":"Window")==="Mac"){if(!b.metaKey||b.key!=="s")return;await s(),b.preventDefault()}else{if(!b.ctrlKey||b.key!=="s")return;await s(),b.preventDefault()}},$e=()=>{I.value=setInterval(async()=>{z.value=JSON.stringify(n.value)!==v.value,c.value&&z.value&&u.value!==Q.ON_UPDATE&&await s(),c.value&&!navigator.onLine&&(c.value=!1),!c.value&&navigator.onLine&&(c.value=!0,await s())},1e4)},De=()=>{clearInterval(I.value)};return ge(async()=>{window.addEventListener("scroll",T),window.addEventListener("keydown",ie,!1),$e(),await G()}),Ne(()=>{window.removeEventListener("scroll",T),window.removeEventListener("keydown",ie),De()}),(b,x)=>(r(),N(Me,{"document-unit":n.value},{default:C(({classes:V})=>[i("div",Hn,[i("div",{class:M(V)},[h(wn,{id:"coreData",modelValue:p(g),"onUpdate:modelValue":x[0]||(x[0]=S=>q(g)?g.value=S:null),"update-status":u.value,"validation-errors":f.value.filter(S=>S.field.split(".")[0]==="coreData"),onUpdateDocumentUnit:s},null,8,["modelValue","update-status","validation-errors"]),h(Gn,{id:"proceedingDecisions","document-unit-uuid":n.value.uuid,"proceeding-decisions":t.documentUnit.proceedingDecisions},null,8,["document-unit-uuid","proceeding-decisions"]),h($n,{id:"texts",texts:t.documentUnit.texts,"update-status":u.value,onUpdateDocumentUnit:s,onUpdateValue:o},null,8,["texts","update-status"]),h(cn,{id:"contentRelatedIndexing","document-unit":e.documentUnit},null,8,["document-unit"])],2),i("div",{class:M(["bg-white border-gray-400 border-l-1 border-solid",{full:p(L)}])},[h(Re,{id:"odoc-panel-element",open:p(L),"onUpdate:open":x[1]||(x[1]=S=>q(L)?L.value=S:null),class:M(["bg-white",V]),file:_.value,"fixed-panel-position":w.value,"has-file":t.documentUnit.hasFile},null,8,["open","class","file","fixed-panel-position","has-file"])],2)])]),_:1},8,["document-unit"]))}});const qn=K(Wn,[["__scopeId","data-v-cfaab6ff"]]),Jn={key:1},fo=y({__name:"categories",props:{documentNumber:null},async setup(t){let e,n;const o=t,{data:s,error:a}=([e,n]=pe(()=>se.getByDocumentNumber(o.documentNumber)),e=await e,n(),e);return(l,c)=>{var f,u;return p(s)?(r(),N(qn,{key:0,"document-unit":p(s)},null,8,["document-unit"])):(r(),m("div",Jn,[i("h2",null,$((f=p(a))==null?void 0:f.title),1),i("p",null,$((u=p(a))==null?void 0:u.description),1)]))}}});export{fo as default};
